<style>
/* 相続ガリ版配信履歴のスタイル */
.inheritance-gali-container * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

.inheritance-gali-container {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #ffffff;
    min-height: 100vh;
    padding: 20px;
}

.inheritance-gali-container .container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 15px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    overflow: hidden;
}

.inheritance-gali-container .header {
    background: #142464;
    color: white;
    padding: 30px;
    text-align: center;
}

.inheritance-gali-container .header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    font-weight: 300;
}

.inheritance-gali-container .header p {
    font-size: 1.1rem;
    opacity: 0.9;
}

.inheritance-gali-container .controls {
    padding: 30px;
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
}

.inheritance-gali-container .search-filter {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    align-items: center;
}

.inheritance-gali-container .search-box {
    flex: 1;
    min-width: 300px;
    position: relative;
}

.inheritance-gali-container .search-box input {
    width: 100%;
    padding: 12px 20px;
    border: 2px solid #e9ecef;
    border-radius: 25px;
    font-size: 16px;
    transition: all 0.3s ease;
}

.inheritance-gali-container .search-box input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.inheritance-gali-container .filter-group {
    display: flex;
    gap: 15px;
    align-items: center;
}

.inheritance-gali-container .filter-group select {
    padding: 10px 15px;
    border: 2px solid #e9ecef;
    border-radius: 20px;
    background: white;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.inheritance-gali-container .filter-group select:focus {
    outline: none;
    border-color: #667eea;
}

.inheritance-gali-container .bookmarks-container {
    padding: 30px;
}

.inheritance-gali-container .bookmark-item {
    background: white;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    transition: all 0.3s ease;
    cursor: pointer;
}

.inheritance-gali-container .bookmark-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    border-color: #667eea;
}

.inheritance-gali-container .bookmark-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 15px;
}

.inheritance-gali-container .bookmark-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #333;
    margin-bottom: 5px;
}

.inheritance-gali-container .bookmark-description {
    font-size: 0.95rem;
    color: #666;
    line-height: 1.5;
    margin-bottom: 10px;
    max-width: 600px;
}

.inheritance-gali-container .bookmark-url {
    color: #667eea;
    text-decoration: none;
    font-size: 0.9rem;
    word-break: break-all;
}

.inheritance-gali-container .bookmark-url:hover {
    text-decoration: underline;
}

.inheritance-gali-container .bookmark-meta {
    display: flex;
    gap: 20px;
    font-size: 0.85rem;
    color: #6c757d;
    flex-wrap: wrap;
}

.inheritance-gali-container .meta-item {
    display: flex;
    align-items: center;
    gap: 5px;
}

.inheritance-gali-container .pagination {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 30px;
    margin-bottom: 30px;
}

.inheritance-gali-container .page-btn {
    padding: 10px 15px;
    border: 1px solid #e9ecef;
    background: white;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.inheritance-gali-container .page-btn:hover,
.inheritance-gali-container .page-btn.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

.inheritance-gali-container .no-results {
    text-align: center;
    padding: 50px;
    color: #6c757d;
}

.inheritance-gali-container .no-results h3 {
    margin-bottom: 10px;
    color: #333;
}

@media (max-width: 768px) {
    .inheritance-gali-container .header h1 {
        font-size: 2rem;
    }

    .inheritance-gali-container .search-filter {
        flex-direction: column;
        align-items: stretch;
    }

    .inheritance-gali-container .search-box {
        min-width: auto;
    }

    .inheritance-gali-container .filter-group {
        justify-content: center;
    }

    .inheritance-gali-container .stats {
        justify-content: center;
    }

    .inheritance-gali-container .bookmark-header {
        flex-direction: column;
        gap: 10px;
    }

    .inheritance-gali-container .bookmark-meta {
        flex-direction: column;
        gap: 10px;
    }
}
</style>

<div class="inheritance-gali-container">
    <div class="container">
        <div class="header">
            <h1>📚 相続ガリ版配信履歴</h1>
            <p>過去に配信した相続ガリ版を確認できます</p>
        </div>

        <div class="controls">
            <div class="search-filter">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="相続ガリ版を検索..." onkeyup="filterBookmarks()">
                </div>
            </div>
        </div>

        <div class="bookmarks-container" id="bookmarksContainer">
            <!-- ブックマークアイテムがここに表示されます -->
        </div>

        <div class="pagination" id="pagination">
            <!-- ページネーションがここに表示されます -->
        </div>
    </div>
</div>

<script>
// サンプルデータ
const inheritanceGali = [
    {
        title: "ビジネスガリ版508号",
        description: "レッツ相続申告(No.9) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/08/inheritance_newsletter_508.pdf",
        date: "2025年08月18日",
        publishDate: "2025/08/18 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版507号",
        description: "レッツ相続申告(No.8) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/08/inheritance_newsletter_507.pdf",
        date: "2025年08月11日",
        publishDate: "2025/08/11 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版506号",
        description: "レッツ相続申告(No.7) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/07/inheritance_newsletter_506.pdf",
        date: "2025年07月28日",
        publishDate: "2025/07/28 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版505号",
        description: "レッツ相続申告(No.6) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/07/inheritance_newsletter_505.pdf",
        date: "2025年07月21日",
        publishDate: "2025/07/21 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版504号",
        description: "レッツ相続申告(No.5) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/06/inheritance_newsletter_504_2.pdf",
        date: "2025年06月30日",
        publishDate: "2025/06/30 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版503号",
        description: "レッツ相続申告(No.4) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/05/inheritance_newsletter_503.pdf",
        date: "2025年05月26日",
        publishDate: "2025/05/26 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版502号",
        description: "レッツ相続申告(No.3) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/05/inheritance_newsletter_502.pdf",
        date: "2025年05月19日",
        publishDate: "2025/05/19 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版501号",
        description: "レッツ相続申告(No.2) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/08/inheritance_newsletter_501.pdf",
        date: "2025年05月12日",
        publishDate: "2025/05/12 10:00:00" // 公開日時（日本時間）
    },
    {
        title: "ビジネスガリ版500号",
        description: "レッツ相続申告(No.1) / 相続関連ニュース など",
        url: "https://miocci.com/wp-content/uploads/2025/08/inheritance_newsletter_500.pdf",
        date: "2025年05月05日",
        publishDate: "2025/05/05 10:00:00" // 公開日時（日本時間）
    }
];

let filteredInheritanceGali = [...inheritanceGali];
let currentPage = 1;
const itemsPerPage = 5;

// 公開期限チェック関数（秒まで含む、日本時間）
function isPublishTimeReached(publishDateString) {
    // 現在時刻を取得
    const now = new Date();
    
    // yyyy/mm/dd hh:mm:ss形式をDateオブジェクトに変換
    // 日本時間として解釈するため、UTC+9のタイムゾーンを設定
    const [datePart, timePart] = publishDateString.split(' ');
    const [year, month, day] = datePart.split('/');
    const [hour, minute, second] = timePart.split(':');
    
    // 日本時間のDateオブジェクトを作成
    const publishDate = new Date(year, month - 1, day, hour, minute, second);
    
    // 現在時刻が公開期限以降かどうかを秒まで判定
    return now >= publishDate;
}

// 公開期限に基づいてフィルタリング
function filterByPublishDate() {
    return inheritanceGali.filter(item => {
        return isPublishTimeReached(item.publishDate);
    });
}

// 初期表示
document.addEventListener('DOMContentLoaded', function() {
    // 公開期限に基づいてフィルタリング
    filteredInheritanceGali = filterByPublishDate();
    displayInheritanceGali();
    updatePagination();
});

function filterBookmarks() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();

    // まず公開期限でフィルタリング
    const publishFilteredItems = filterByPublishDate();
    
    // 次に検索条件でフィルタリング
    filteredInheritanceGali = publishFilteredItems.filter(item => {
        const matchesSearch = item.title.toLowerCase().includes(searchTerm);

        return matchesSearch;
    });

    currentPage = 1;
    displayInheritanceGali();
    updatePagination();
}

function displayInheritanceGali() {
    const container = document.getElementById('bookmarksContainer');
    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    const pageItems = filteredInheritanceGali.slice(startIndex, endIndex);

    if (pageItems.length === 0) {
        container.innerHTML = `
            <div class="no-results">
                <h3>🔍 検索結果が見つかりません</h3>
                <p>検索条件を変更してお試しください</p>
            </div>
        `;
        return;
    }

    container.innerHTML = pageItems.map(item => `
        <div class="bookmark-item">
            <div class="bookmark-header">
                <div>
                    <div class="bookmark-title">
                        <a href="${item.url}" target="_blank" style="color: inherit; text-decoration: none;">${item.title}</a>
                    </div>
                    <div class="bookmark-description">
                        ${item.description}
                    </div>
                </div>
                <div class="bookmark-meta">
                    <div class="meta-item">
                        <span>📅</span>
                        <span>${formatDate(item.date)}</span>
                    </div>
                </div>
            </div>
        </div>
    `).join('');
}

function formatDate(dateString) {
    // 日本語の日付形式（YYYY年MM月DD日）の場合は「発行」を追加
    if (dateString.includes('年') && dateString.includes('月') && dateString.includes('日')) {
        return dateString + '発行';
    }
    
    // 通常の日付形式の場合は変換する
    const date = new Date(dateString);
    if (isNaN(date.getTime())) {
        return dateString; // 無効な日付の場合は元の文字列を返す
    }
    return date.toLocaleDateString('ja-JP', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    }) + '発行';
}

function updatePagination() {
    const totalPages = Math.ceil(filteredInheritanceGali.length / itemsPerPage);
    const pagination = document.getElementById('pagination');

    if (totalPages <= 1) {
        pagination.innerHTML = '';
        return;
    }

    let paginationHTML = '';

    // 前のページボタン
    if (currentPage > 1) {
        paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage - 1})">← 前へ</button>`;
    }

    // ページ番号
    for (let i = 1; i <= totalPages; i++) {
        if (i === currentPage) {
            paginationHTML += `<button class="page-btn active">${i}</button>`;
        } else {
            paginationHTML += `<button class="page-btn" onclick="goToPage(${i})">${i}</button>`;
        }
    }

    // 次のページボタン
    if (currentPage < totalPages) {
        paginationHTML += `<button class="page-btn" onclick="goToPage(${currentPage + 1})">次へ →</button>`;
    }

    pagination.innerHTML = paginationHTML;
}

function goToPage(page) {
    currentPage = page;
    displayInheritanceGali();
    updatePagination();
}

function openItem(url) {
    window.open(url, '_blank');
}
</script>
